id: json_page
label: JSON Page Migration
group: json_example
source:
  plugin: json_source
  path: http://d9learning.sf/data/cities.json
# source:
#   plugin: url
#   data_fetcher_plugin: http
#   data_parser_plugin: json
#   url: http://d9learning.sf/data/cities.json
  fields:
    -
      name: _id
      label: 'ID'
      selector: _id
    -
      name: city
      label: 'City'
      selector: city
    -
      name: latitude
      label: 'Latitude'
      selector: loc/0
    -
      name: Longitude
      label: 'Longitude'
      selector: loc/1
    -
      name: pop
      label: 'Pop'
      selector: pop
    -
      name: state
      label: 'State'
      selector: state                  
  
  # ids:
  #   id:
  #     type: integer
  # ids:
  #     nid:
  #       type: integer

destination: 
  plugin: entity:json_migrate

process:
  type:
    plugin: default_value
    default_value: custom_entity 
  _id: _id
  city: city
  longitude: longitude
  latitude: latitude
  pop: pop
  state: state

  sticky:
    plugin: default_value
    default_value: 0
  uid:
    plugin: default_value
    default_value: 0

# use forced module dependency so uninstall/reinstall works properly 
dependencies: 
  enforced: 
    module: 
      - json_migrate 
